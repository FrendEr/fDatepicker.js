!function(a,b){"function"==typeof define&&define.amd?define(["jquery"],function(a){return b()}):"undefined"!=typeof module&&module.exports?module.exports=b():window[a]=b()}("Datepicker",function(){"use strict";function a(b){var b=$.extend(a.DEFAULT,b);this.$container=$(b.container),this.initDate="string"==typeof b.initDate?new Date(b.initDate):b.initDate,this.startDate="string"==typeof b.startDate?new Date(b.startDate):b.startDate,this.endDate="string"==typeof b.endDate?new Date(b.endDate):b.endDate,this.initFrames=b.initFrame,this.restFrames=0,this.loadFrames=b.loadFrames,this.tmpYear=0,this.tmpMonth=0,this.loadOffset=b.loadOffset,this.singleFrame=b.singleFrame,this.i18n=b.i18n,this.selectCallback=b.selectCallback,$(window).on("scroll",$.proxy(this.scrollLoad,this)),this.$container.on("click","span[data-date]",$.proxy(this.initEvents,this)),this.init()}a.VERSION="1.0.0",a.DEFAULT={container:"",initDate:"",startDate:"",endDate:"",singleFrame:!1,initFrames:3,loadFrames:3,loadOffset:100,i18n:!1,selectCallback:$.noop},a.prototype={constructor:a,init:function(){var a=this,c=this.getStartYear(),d=this.getStartMonth(),e=this.getEndYear(),f=this.getEndMonth();if(!(c>e||c==e&&d>f)){if(this.singleFrame||c==e&&d==f)return void this.$container.append(b.renderSinglePicker(c,d,a));if(!this.singleFrame)if(this.restFrames=12*(e-c)+f-d-this.initFrames,this.restFrames>0){var g=this.tmpYear=c+(d+this.initFrames>11?1:0),h=this.tmpMonth=(d+this.initFrames-1)%12;this.$container.append(b.renderMutiplePicker(c,d,g,h,a))}else this.$container.append(b.renderMutiplePicker(c,d,e,f,a))}},initEvents:function(a){var b="span"==a.target.tagName.toLowerCase()?$(a.target):$(a.target).parents("span");b.is(".is-outdate")||b.is(".is-today")||(this.$container.find(".selected").removeClass("selected"),b.addClass("selected"),this.initDate=new Date(b.data("date")),this.selectCallback.call(this,b.data("date")))},getStartYear:function(){return this.startDate.getFullYear()},getStartMonth:function(){return this.startDate.getMonth()},getEndYear:function(){return this.endDate.getFullYear()},getEndMonth:function(){return this.endDate.getMonth()},scrollLoad:function(){if(!(this.restFrames<=0)){var a,c,d=this,e=$(window),f=$(document),g=this.tmpYear,h=this.tmpMonth+1;f.height()-e.height()-e.scrollTop()<this.loadOffset&&(this.restFrames<=this.loadFrames?(this.restFrames=0,a=this.getEndYear(),c=this.getEndMonth(),this.$container.append(b.renderMutiplePicker(g,h,a,c,d))):(this.restFrames-=this.loadFrames,a=this.tmpYear=g+(h+this.loadFrames>11?1:0),c=this.tmpMonth=(h+this.loadFrames-1)%12,this.$container.append(b.renderMutiplePicker(g,h,a,c,d))))}}};var b={weeks:["日","一","二","三","四","五","六"],weeksi18n:["Sun","Mon","Tues","Wed","Thur","Fri","Sat"],months:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],monthsi18n:["January","February","March","April","May","June","July","August","September","October","November","December"],getCurrentDate:function(){return new Date},getMonthFirstDay:function(a,b){return new Date(a,b,1).getDay()},getMonthLastDay:function(a,b){return new Date(a,b+1,0).getDate()},fillArr:function(a,b){for(var c=this.getMonthFirstDay(a,b),d=this.getMonthLastDay(a,b),e=d,f=c+d>36?new Array(42):c+d>28?new Array(35):new Array(28),g=c,h=0;e>h;h++,g++)f[g]=a+"/"+(b+1)+"/"+(h+1);return f},renderSinglePicker:function(a,b,c){for(var d=c.i18n?this.weeksi18n:this.weeks,e=c.i18n?this.monthsi18n[b]+" "+a:a+"年 "+this.months[b],f=$('<div class="datepicker-table"><h2 class="datepicker-header">'+e+"</h2>"+function(){for(var a="",b=0;b<d.length;b++)a+='<span class="dp-th">'+d[b]+"</span>";return a}()+"</div>"),g=this.fillArr(a,b),h=this.getCurrentDate(),i=c.initDate.getTime(),j="",k=0;k<g.length;k++)void 0==g[k]?j+="<span></span>":function(a){var b=g[a].split("/"),c=parseInt(b[0]),d=parseInt(b[1])-1,e=parseInt(b[2]),f="";f+=new Date(g[a])<h?"is-outdate ":"",f+=h.getFullYear()==c&&parseInt(h.getMonth())==d&&parseInt(h.getDate())==e?"is-today ":"",f+=-1!=f.indexOf("is-outdate")?"":-1!=f.indexOf("is-today")?"":new Date(g[a]).getTime()==i?"selected":"",(a%7==0||a%7==6)&&(f+=" is-weekend"),j+='<span class="'+f+'" data-date="'+g[a]+'"><i>'+e+"</i></span>"}(k);return f.append(j)},renderMutiplePicker:function(a,b,c,d,e){for(var f=c-a,g=12*f+d-b,h=$("<div/>"),i=0;g>=i;i++){var j=(b+i)%12,k=b+i>=12?a+1:a;h.append(this.renderSinglePicker(k,j,e))}return h}};return a});