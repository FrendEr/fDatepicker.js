!function(a,b){"function"==typeof define&&define.amd?define(["jquery"],function(a){return b()}):"undefined"!=typeof module&&module.exports?module.exports=b():window[a]=b()}("Datepicker",function(){"use strict";function a(b){var b=$.extend(a.DEFAULT,b);this.$container=$(b.container),this.startDate="string"==typeof b.startDate?new Date(b.startDate):b.startDate,this.endDate="string"==typeof b.endDate?new Date(b.endDate):b.endDate,this.initFrames=b.initFrame,this.restFrames=0,this.loadFrames=b.loadFrames,this.tmpYear=0,this.tmpMonth=0,this.loadOffset=b.loadOffset,this.singleFrame=b.singleFrame,this.i18n=b.i18n,this.selectCallback=b.selectCallback,$(window).on("scroll",$.proxy(this.scrollLoad,this)),this.$container.on("click","span[data-date]",$.proxy(this.initEvents,this)),this.init()}a.VERSION="1.0.0",a.DEFAULT={container:"",startDate:"",endDate:"",singleFrame:!1,initFrames:3,loadFrames:3,loadOffset:100,i18n:!1,selectCallback:$.noop},a.prototype={constructor:a,init:function(){var a=this.getStartYear(),c=this.getStartMonth(),d=this.getEndYear(),e=this.getEndMonth();if(!(a>d||a==d&&c>e)){if(this.singleFrame||a==d&&c==e)return void this.$container.append(b.renderSinglePicker(a,c));if(!this.singleFrame)if(this.restFrames=12*(d-a)+e-c-this.initFrames,this.restFrames>0){var f=this.tmpYear=a+(c+this.initFrames>11?1:0),g=this.tmpMonth=(c+this.initFrames-1)%12;this.$container.append(b.renderMutiplePicker(a,c,f,g))}else this.$container.append(b.renderMutiplePicker(a,c,d,e))}},initEvents:function(a){var b="span"==a.target.tagName.toLowerCase()?$(a.target):$(a.target).parents("span");b.is(".is-outdate")||b.is(".is-today")||(this.$container.find(".selected").removeClass("selected"),b.addClass("selected"),this.selectCallback.call(this,b.data("date")))},getStartYear:function(){return this.startDate.getFullYear()},getStartMonth:function(){return this.startDate.getMonth()},getEndYear:function(){return this.endDate.getFullYear()},getEndMonth:function(){return this.endDate.getMonth()},scrollLoad:function(){if(!(this.restFrames<=0)){var a,c,d=$(window),e=$(document),f=this.tmpYear,g=this.tmpMonth+1;e.height()-d.height()-d.scrollTop()<this.loadOffset&&(this.restFrames<=this.loadFrames?(this.restFrames=0,a=this.getEndYear(),c=this.getEndMonth(),this.$container.append(b.renderMutiplePicker(f,g,a,c))):(this.restFrames-=this.loadFrames,a=this.tmpYear=f+(g+this.loadFrames>11?1:0),c=this.tmpMonth=(g+this.loadFrames-1)%12,this.$container.append(b.renderMutiplePicker(f,g,a,c))))}}};var b={weeks:["日","一","二","三","四","五","六"],weeksi18n:["Sun","Mon","Tues","Wed","Thur","Fri","Sat"],getCurrentDate:function(){return new Date},getMonthFirstDay:function(a,b){return new Date(a,b,1).getDay()},getMonthLastDay:function(a,b){return new Date(a,b+1,0).getDate()},fillArr:function(a,b){for(var c=this.getMonthFirstDay(a,b),d=this.getMonthLastDay(a,b),e=d,f=c+d>36?new Array(42):c+d>28?new Array(35):new Array(28),g=c,h=0;e>h;h++,g++)f[g]=a+"/"+(b+1)+"/"+(h+1);return f},renderSinglePicker:function(a,b){for(var c=this,d=$('<div class="datepicker-table"><h2 class="datepicker-header">'+a+"年"+(b+1)+"月</h2>"+function(){for(var a="",b=0;b<c.weeks.length;b++)a+='<span class="dp-th">'+c.weeks[b]+"</span>";return a}()+"</div>"),e=this.fillArr(a,b),f=this.getCurrentDate(),g="",h=0;h<e.length;h++)void 0==e[h]?g+="<span></span>":function(a){var b=e[a].split("/"),c=parseInt(b[0]),d=parseInt(b[1])-1,h=parseInt(b[2]),i="";i+=new Date(e[a])<f?"is-outdate ":"",i+=f.getFullYear()==c&&parseInt(f.getMonth())==d&&parseInt(f.getDate())==h?"is-today ":"",(a%7==0||a%7==6)&&(i+=" is-weekend"),g+='<span class="'+i+'" data-date="'+e[a]+'"><i>'+h+"</i></span>"}(h);return d.append(g)},renderMutiplePicker:function(a,b,c,d){for(var e=c-a,f=12*e+d-b,g=$("<div/>"),h=0;f>=h;h++){var i=(b+h)%12,j=b+h>=12?a+1:a;g.append(this.renderSinglePicker(j,i))}return g}};return a});